# Gemini CLI ワークフロー (`gemini-cli.yml`)

このワークフローは、権限のあるユーザーがGitHubのIssueやプルリクエストから直接Gemini CLIと対話することを可能にします。

## トリガー

このワークフローは、以下のイベントによってトリガーされます。

- **プルリクエストのレビューコメント:** プルリクエストのレビューにコメントが作成されたとき。
- **プルリクエストのレビュー:** プルリクエストのレビューが提出されたとき。
- **Issueへのコメント:** Issueにコメントが作成されたとき。

## 主な機能

- **同時実行制御:** 同じIssueで複数のワークフローが同時に実行されるのを防ぎ、競合状態を回避します。
- **権限設定:** ワークフローは、コンテンツ、プルリクエスト、Issueへの書き込み権限を持ち、ファイルの変更、コメントの作成、PRの更新が可能です。
- **コンテキスト抽出:** イベントのペイロードから、ユーザーのリクエスト、Issue/PR番号、その他の関連コンテキストを賢く抽出します。
- **ブランチ管理:** Issueの場合、作業用の新しいブランチを自動的に作成し、`main`ブランチが直接変更されないようにします。
- **Gemini連携:** `google-github-actions/run-gemini-cli` アクションを使用してユーザーのリクエストを処理します。これには以下が含まれます。
    - **計画:** 複雑なリクエストに対して、ユーザーの承認を得るための計画を生成します。
    - **実行:** 承認された計画を実行し、コードの変更を行い、適切なブランチにコミットします。
    - **コミュニケーション:** Issueやプルリクエストにコメントを投稿して、ユーザーに進捗を知らせます。
- **セキュリティ:** 個人のアクセストークンよりも安全なGitHub Appトークンを使用して認証を行います。
